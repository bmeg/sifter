<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
  <title>Overview &middot; Sifter</title>
  

  
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/poole.css">
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/darcula.css">
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/syntax.css">
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/theme.css">
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/funnel.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  <script src="https://bmeg.github.io/sifter/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body>

  <div class="global-header">
    <div class="global-header-container">
      <div class="global-header-home">
        <a href="https://bmeg.github.io/sifter"><h1>Sifter</h1></a>
      </div>
      <ul class="global-header-nav">
          <li><a href="https://github.com/bmeg/sifter/releases">Download</a></li>
          <li><a href="https://bmeg.github.io/sifter/docs/">Docs</a></li>
          <li><a href="https://github.com/bmeg/sifter">GitHub</a></li>
        </ul>
    </div>
  </div>


<div class="content section group">

  <div class="sidebar col span_3_of_12">
    <ul class="sidebar-nav">
      
      
        
        <li>
          
          <a href="/sifter/docs/"
             class="sidebar-nav-item  active"
          >Overview</a></li>
          
        
        <li>
          
          <a href="/sifter/docs/example/"
             class="sidebar-nav-item "
          >Example</a></li>
          
        
        <li>
          
          
          <span class="intermediate"><a href="/sifter/docs/inputs/">Inputs</a></span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/avroload/"
                   class="sidebar-nav-item "
                >avroLoad</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/embedded/"
                   class="sidebar-nav-item "
                >embedded</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/glob/"
                   class="sidebar-nav-item "
                >glob</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/plugin/"
                   class="sidebar-nav-item "
                >input plugin</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/jsonload/"
                   class="sidebar-nav-item "
                >jsonLoad</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/sqldump/"
                   class="sidebar-nav-item "
                >sqldump</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/sqliteload/"
                   class="sidebar-nav-item "
                >sqliteLoad</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/tableload/"
                   class="sidebar-nav-item "
                >tableLoad</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/xmlload/"
                   class="sidebar-nav-item "
                >xmlLoad</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          
          <span class="intermediate"><a href="/sifter/docs/transforms/">Pipeline Steps</a></span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/accumulate/"
                   class="sidebar-nav-item "
                >accumulate</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/clean/"
                   class="sidebar-nav-item "
                >clean</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/debug/"
                   class="sidebar-nav-item "
                >debug</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/distinct/"
                   class="sidebar-nav-item "
                >distinct</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/emit/"
                   class="sidebar-nav-item "
                >emit</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/fieldparse/"
                   class="sidebar-nav-item "
                >fieldParse</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/fieldprocess/"
                   class="sidebar-nav-item "
                >fieldProcess</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/fieldtype/"
                   class="sidebar-nav-item "
                >fieldType</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/filter/"
                   class="sidebar-nav-item "
                >filter</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/flatmap/"
                   class="sidebar-nav-item "
                >flatMap</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/from/"
                   class="sidebar-nav-item "
                >from</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/graphbuild/"
                   class="sidebar-nav-item "
                >graphBuild</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/hash/"
                   class="sidebar-nav-item "
                >hash</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/lookup/"
                   class="sidebar-nav-item "
                >lookup</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/map/"
                   class="sidebar-nav-item "
                >map</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/objectvalidate/"
                   class="sidebar-nav-item "
                >objectValidate</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/project/"
                   class="sidebar-nav-item "
                >project</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/reduce/"
                   class="sidebar-nav-item "
                >reduce</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/regexreplace/"
                   class="sidebar-nav-item "
                >regexReplace</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/split/"
                   class="sidebar-nav-item "
                >split</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/tablewrite/"
                   class="sidebar-nav-item "
                >tableWrite</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/plugin/"
                   class="sidebar-nav-item "
                >transform plugin</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/uuid/"
                   class="sidebar-nav-item "
                >uuid</a></li>
            </ul>
          </li>
          
          
        
      
    </ul>
  </div>

  <div class="main col span_8_of_12">
    <h1 id="sifter-pipelines">Sifter pipelines</h1>
<p>Sifter pipelines process steams of nested JSON messages. Sifter comes with a number of
file extractors that operate as inputs to these pipelines. The pipeline engine
connects togeather arrays of transform steps into directed acylic graph that is processed
in parallel.</p>
<p>Example Message:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;firstName&#34;</span> : <span style="color:#e6db74">&#34;bob&#34;</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;age&#34;</span> : <span style="color:#e6db74">&#34;25&#34;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#e6db74">&#34;friends&#34;</span> : [ <span style="color:#e6db74">&#34;Max&#34;</span>, <span style="color:#e6db74">&#34;Alex&#34;</span>]
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>Once a stream of messages are produced, that can be run through a transform
pipeline. A transform pipeline is an array of transform steps, each transform
step can represent a different way to alter the data. The array of transforms link
togeather into a pipe that makes multiple alterations to messages as they are
passed along. There are a number of different transform steps types that can
be done in a transform pipeline these include:</p>
<ul>
<li>Projection: creating new fields using a templating engine driven by existing values</li>
<li>Filtering: removing messages</li>
<li>Programmatic transformation: alter messages using an embedded python interpreter</li>
<li>Table based field translation</li>
<li>Outputing the message as a JSON Schema checked object</li>
</ul>
<h1 id="script-structure">Script structure</h1>
<h1 id="pipeline-file">Pipeline File</h1>
<p>An sifter pipeline file is in YAML format and describes an entire processing pipelines.
If is composed of the following sections: <code>config</code>, <code>inputs</code>, <code>pipelines</code>, <code>outputs</code>. In addition,
for tracking, the file will also include <code>name</code> and <code>class</code> entries.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">class</span>: <span style="color:#ae81ff">sifter</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">&lt;script name&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">outdir</span>: <span style="color:#ae81ff">&lt;where output files should go, relative to this file&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">config</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;config key&gt;</span>: <span style="color:#ae81ff">&lt;config value&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;config key&gt;</span>: <span style="color:#ae81ff">&lt;config value&gt; </span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># values that are referenced in pipeline parameters for </span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># files will be treated like file paths and be </span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># translated to full paths</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">inputs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;input name&gt;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;input driver&gt;</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">&lt;driver config&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">pipelines</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;pipeline name&gt;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#75715e"># all pipelines must start with a from step</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">from</span>: <span style="color:#ae81ff">&lt;name of input or pipeline&gt; </span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">&lt;transform name&gt;</span>:
</span></span><span style="display:flex;"><span>       <span style="color:#ae81ff">&lt;transform parameters&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">outputs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;output name&gt;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&lt;output driver&gt;</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#ae81ff">&lt;driver config&gt;</span>
</span></span></code></pre></div><h2 id="header">Header</h2>
<p>Each sifter file starts with a set of field to let the software know this is a sifter script, and not some random YAML file. There is also a <code>name</code> field for the script. This name will be used for output file creation and logging. Finally, there is an <code>outdir</code> that defines the directory where all output files will be placed. All paths are relative to the script file, so the <code>outdir</code> set to <code>my-results</code> will create the directory <code>my-results</code> in the same directory as the script file, regardless of where the sifter command is invoked.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">class </span>: <span style="color:#ae81ff">sifter</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">&lt;name of script&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">outdir</span>: <span style="color:#ae81ff">&lt;where files should be stored&gt;</span>
</span></span></code></pre></div><h1 id="config-and-templating">Config and templating</h1>
<p>The <code>config</code> section is a set of defined keys that are used throughout the rest of the script.</p>
<p>Example config:</p>
<pre tabindex="0"><code>config:
  sqlite:  ../../source/chembl/chembl_33/chembl_33_sqlite/chembl_33.db
  uniprot2ensembl: ../../tables/uniprot2ensembl.tsv
  schema: ../../schema/
</code></pre><p>Various fields in the script file will be be parsed using a <a href="https://mustache.github.io/">Mustache</a> template engine. For example, to access the various values within the config block, the template <code>{{config.sqlite}}</code>.</p>
<h1 id="inputs">Inputs</h1>
<p>The input block defines the various data extractors that will be used to open resources and create streams of JSON messages for processing. The possible input engines include:</p>
<ul>
<li>AVRO</li>
<li>JSON</li>
<li>XML</li>
<li>SQL-dump</li>
<li>SQLite</li>
<li>TSV/CSV</li>
<li>GLOB</li>
</ul>
<p>For any other file types, there is also a plugin option to allow the user to call their own code for opening files.</p>
<h1 id="pipeline">Pipeline</h1>
<p>The <code>pipelines</code> defined a set of named processing pipelines that can be used to transform data. Each pipeline starts with a <code>from</code> statement that defines where data comes from. It then defines a linear set of transforms that are chained togeather to do processing. Pipelines may used <code>emit</code> steps to output messages to disk. The possible data transform steps include:</p>
<ul>
<li>Accumulate</li>
<li>Clean</li>
<li>Distinct</li>
<li>DropNull</li>
<li>Field Parse</li>
<li>Field Process</li>
<li>Field Type</li>
<li>Filter</li>
<li>FlatMap</li>
<li>GraphBuild</li>
<li>Hash</li>
<li>JSON Parse</li>
<li>Lookup</li>
<li>Value Mapping</li>
<li>Object Validation</li>
<li>Project</li>
<li>Reduce</li>
<li>Regex</li>
<li>Split</li>
<li>UUID Generation</li>
</ul>
<p>Additionally, users are able to define their one transform step types using the <code>plugin</code> step.</p>
<h1 id="example-script">Example script</h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">class</span>: <span style="color:#ae81ff">sifter</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">name</span>: <span style="color:#ae81ff">go</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">outdir</span>: <span style="color:#ae81ff">../../output/go/</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">config</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">oboFile</span>: <span style="color:#ae81ff">../../source/go/go.obo</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">schema</span>: <span style="color:#ae81ff">../../schema</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">inputs</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">oboData</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">plugin</span>:
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">commandLine</span>: <span style="color:#ae81ff">../../util/obo_reader.py {{config.oboFile}}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">pipelines</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">transform</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">from</span>: <span style="color:#ae81ff">oboData</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">project</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">mapping</span>:
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">submitter_id</span>: <span style="color:#e6db74">&#34;{{row.id[0]}}&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">case_id</span>: <span style="color:#e6db74">&#34;{{row.id[0]}}&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">id</span>: <span style="color:#e6db74">&#34;{{row.id[0]}}&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">go_id</span>: <span style="color:#e6db74">&#34;{{row.id[0]}}&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">project_id</span>: <span style="color:#e6db74">&#34;gene_onotology&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">namespace</span>: <span style="color:#e6db74">&#34;{{row.namespace[0]}}&#34;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;{{row.name[0]}}&#34;</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">map</span>: 
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">method</span>: <span style="color:#ae81ff">fix</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">gpython</span>: <span style="color:#ae81ff">| </span>
</span></span><span style="display:flex;"><span>          <span style="color:#f92672">def fix(row)</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">row[&#39;definition&#39;] = row[&#39;def&#39;][0].strip(&#39;&#34;&#39;)</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">if &#39;xref&#39; not in row</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#ae81ff">row[&#39;xref&#39;] = []</span>
</span></span><span style="display:flex;"><span>            <span style="color:#f92672">if &#39;synonym&#39; not in row</span>:
</span></span><span style="display:flex;"><span>              <span style="color:#ae81ff">row[&#39;synonym&#39;] = []</span>
</span></span><span style="display:flex;"><span>            <span style="color:#ae81ff">return row</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">objectValidate</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">title</span>: <span style="color:#ae81ff">GeneOntologyTerm</span>
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">schema</span>: <span style="color:#e6db74">&#34;{{config.schema}}&#34;</span>
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">emit</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">name</span>: <span style="color:#ae81ff">term</span>
</span></span></code></pre></div>
  </div>

</div>
</body>
</html>
