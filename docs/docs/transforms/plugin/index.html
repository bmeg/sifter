<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us" lang="en-us">
<head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">

  
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  
  <title>transform plugin &middot; Sifter</title>
  

  
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/poole.css">
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/darcula.css">
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/syntax.css">
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/theme.css">
  <link rel="stylesheet" href="https://bmeg.github.io/sifter/css/funnel.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400italic,700">

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  <script src="https://bmeg.github.io/sifter/js/highlight.pack.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>

</head>
<body>

  <div class="global-header">
    <div class="global-header-container">
      <div class="global-header-home">
        <a href="https://bmeg.github.io/sifter"><h1>Sifter</h1></a>
      </div>
      <ul class="global-header-nav">
          <li><a href="https://github.com/bmeg/sifter/releases">Download</a></li>
          <li><a href="https://bmeg.github.io/sifter/docs/">Docs</a></li>
          <li><a href="https://github.com/bmeg/sifter">GitHub</a></li>
        </ul>
    </div>
  </div>


<div class="content section group">

  <div class="sidebar col span_3_of_12">
    <ul class="sidebar-nav">
      
      
        
        <li>
          
          <a href="/sifter/docs/"
             class="sidebar-nav-item "
          >Overview</a></li>
          
        
        <li>
          
          <a href="/sifter/docs/example/"
             class="sidebar-nav-item "
          >Example</a></li>
          
        
        <li>
          
          
          <span class="intermediate"><a href="/sifter/docs/inputs/">Inputs</a></span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/avroload/"
                   class="sidebar-nav-item "
                >avroLoad</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/embedded/"
                   class="sidebar-nav-item "
                >embedded</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/glob/"
                   class="sidebar-nav-item "
                >glob</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/plugin/"
                   class="sidebar-nav-item "
                >input plugin</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/jsonload/"
                   class="sidebar-nav-item "
                >jsonLoad</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/sqldump/"
                   class="sidebar-nav-item "
                >sqldump</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/sqliteload/"
                   class="sidebar-nav-item "
                >sqliteLoad</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/tableload/"
                   class="sidebar-nav-item "
                >tableLoad</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/inputs/xmlload/"
                   class="sidebar-nav-item "
                >xmlLoad</a></li>
            </ul>
          </li>
          
          
        
        <li>
          
          
          <span class="intermediate"><a href="/sifter/docs/transforms/">Pipeline Steps</a></span></li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/accumulate/"
                   class="sidebar-nav-item "
                >accumulate</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/clean/"
                   class="sidebar-nav-item "
                >clean</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/debug/"
                   class="sidebar-nav-item "
                >debug</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/distinct/"
                   class="sidebar-nav-item "
                >distinct</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/emit/"
                   class="sidebar-nav-item "
                >emit</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/fieldparse/"
                   class="sidebar-nav-item "
                >fieldParse</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/fieldprocess/"
                   class="sidebar-nav-item "
                >fieldProcess</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/fieldtype/"
                   class="sidebar-nav-item "
                >fieldType</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/filter/"
                   class="sidebar-nav-item "
                >filter</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/flatmap/"
                   class="sidebar-nav-item "
                >flatMap</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/from/"
                   class="sidebar-nav-item "
                >from</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/graphbuild/"
                   class="sidebar-nav-item "
                >graphBuild</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/hash/"
                   class="sidebar-nav-item "
                >hash</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/lookup/"
                   class="sidebar-nav-item "
                >lookup</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/map/"
                   class="sidebar-nav-item "
                >map</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/objectvalidate/"
                   class="sidebar-nav-item "
                >objectValidate</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/project/"
                   class="sidebar-nav-item "
                >project</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/reduce/"
                   class="sidebar-nav-item "
                >reduce</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/regexreplace/"
                   class="sidebar-nav-item "
                >regexReplace</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/split/"
                   class="sidebar-nav-item "
                >split</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/tablewrite/"
                   class="sidebar-nav-item "
                >tableWrite</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/plugin/"
                   class="sidebar-nav-item  active"
                >transform plugin</a></li>
            </ul>
          </li>
          
          <li>
            <ul class="sidebar-nav sidebar-nav-nested">
              <li>
                <a href="/sifter/docs/transforms/uuid/"
                   class="sidebar-nav-item "
                >uuid</a></li>
            </ul>
          </li>
          
          
        
      
    </ul>
  </div>

  <div class="main col span_8_of_12">
    <h1 id="plugin">plugin</h1>
<p>Invoke external program for data processing</p>
<h2 id="parameters">Parameters</h2>
<table>
<thead>
<tr>
<th>name</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>commandLine</td>
<td>Command line program to be called</td>
</tr>
</tbody>
</table>
<p>The command line can be written in any language. Sifter and the
plugin communicate via NDJSON. Sifter streams the input to the program via
STDIN and the plugin returns results via STDOUT. Any loggin or additional
data must be sent to STDERR, or it will interupt the stream of messages.
The command line code is executed using the base directory of the
sifter file as the working directory.</p>
<h2 id="example">Example</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>    - <span style="color:#f92672">plugin</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#f92672">commandLine</span>: <span style="color:#e6db74">&#34;../../util/calc_fingerprint.py&#34;</span>
</span></span></code></pre></div><p>In this case, the plugin code is</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#75715e">#!/usr/bin/env python</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> sys
</span></span><span style="display:flex;"><span><span style="color:#f92672">import</span> json
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rdkit <span style="color:#f92672">import</span> Chem
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> rdkit.Chem <span style="color:#f92672">import</span> AllChem
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">for</span> line <span style="color:#f92672">in</span> sys<span style="color:#f92672">.</span>stdin:
</span></span><span style="display:flex;"><span>    row <span style="color:#f92672">=</span> json<span style="color:#f92672">.</span>loads(line)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> <span style="color:#e6db74">&#34;canonical_smiles&#34;</span> <span style="color:#f92672">in</span> row:
</span></span><span style="display:flex;"><span>        smiles <span style="color:#f92672">=</span> row[<span style="color:#e6db74">&#34;canonical_smiles&#34;</span>]
</span></span><span style="display:flex;"><span>        m <span style="color:#f92672">=</span> Chem<span style="color:#f92672">.</span>MolFromSmiles(smiles)
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">try</span>:
</span></span><span style="display:flex;"><span>            fp <span style="color:#f92672">=</span> AllChem<span style="color:#f92672">.</span>GetMorganFingerprintAsBitVect(m, radius<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span>)
</span></span><span style="display:flex;"><span>            fingerprint <span style="color:#f92672">=</span> list(fp)
</span></span><span style="display:flex;"><span>            row[<span style="color:#e6db74">&#34;morgan_fingerprint_2&#34;</span>] <span style="color:#f92672">=</span> fingerprint
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">except</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#66d9ef">pass</span>
</span></span><span style="display:flex;"><span>    print(json<span style="color:#f92672">.</span>dumps(row))
</span></span></code></pre></div>
  </div>

</div>
</body>
</html>
