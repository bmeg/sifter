
inputs:
  sifFile:
    type: File
    default: ../../resources/pathways.sif

sources:
  sifFile:
    tableLoad:
      input: "{{inputs.sifFile}}"
      sep: "\t"
      columns: [_from, _label, _to]

links:
  geneReduce: sifFile

pipelines:
  geneReduce:
    - reduce:
        field: _from
        init: { "_to" : [] }
        method: merge
        gpython: |

          def merge(x,y):
            y["_from"] = x["_from"]
            y["_to"].append(x["_to"])
            return y
    - debug: {}
